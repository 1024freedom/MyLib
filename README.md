/**
 * 贝塞尔曲线更新阳光球状态示例
 * 此函数在游戏主循环中每帧调用，用于更新所有阳光球的状态和位置
 */
void updateSunshine(float deltaTime, std::vector<SunshineBall>& balls, int& sunshine) {
    // 遍历所有阳光球
    for (auto& ball : balls) {
        // 只处理处于收集状态的阳光球
        if (ball.status == SUNSHINE_COLLECT) {
            
            /******************************************************************
             * 关键代码：使用deltaTime推进动画进度
             * 
             * ball.speed: 动画速度系数（单位：1/秒）
             * deltaTime: 上一帧到当前帧的时间间隔（秒）
             * ball.t: 动画进度值（0.0-1.0）
             * 
             * 公式: ball.t += ball.speed * deltaTime
             * 
             * 作用:
             * 1. 确保在不同帧率下动画速度一致
             * 2. 实现帧率无关的平滑动画
             * 3. 根据实际时间推进动画进度
             ******************************************************************/
            ball.t += ball.speed * deltaTime;
            
            /******************************************************************
             * 计算贝塞尔曲线上的当前位置
             * 
             * 使用三次贝塞尔曲线公式计算阳光球当前帧的位置:
             * B(t) = (1-t)³P₀ + 3(1-t)²tP₁ + 3(1-t)t²P₂ + t³P₃
             * 
             * 参数:
             * ball.t: 当前动画进度（0.0起点，1.0终点）
             * ball.p0, ball.p1, ball.p2, ball.p3: 贝塞尔曲线的四个控制点
             * 
             * 曲线特性:
             * - P0: 起点（点击位置）
             * - P1: 第一个控制点（左上方向）
             * - P2: 第二个控制点（右上方向）
             * - P3: 终点（收集栏位置）
             * 
             * 形成先上升后下降的拱形轨迹，增强视觉效果
             ******************************************************************/
            ball.position = calcBezierPoint(ball.t, ball.p0, ball.p1, ball.p2, ball.p3);
            
            /******************************************************************
             * 检查动画是否完成
             * 
             * 当动画进度t >= 1.0时:
             * 1. 增加阳光值
             * 2. 标记阳光球为未激活状态
             * 
             * 注意:
             * - 使用>=而非==防止跳过完成检查
             * - 确保动画完成时只执行一次收集操作
             ******************************************************************/
            if (ball.t >= 1.0f) {
                // 增加阳光值（25是每个阳光球的价值）
                sunshine += 25;
                
                // 播放收集音效
                playSound("sunshine_collect.wav");
                
                // 标记阳光球为未激活状态（后续将被回收）
                ball.active = false;
                
                // 可选：添加视觉反馈（如粒子效果）
                spawnParticles(ball.position, SUNSHINE_COLLECT_EFFECT);
            }
        }
    }
}
